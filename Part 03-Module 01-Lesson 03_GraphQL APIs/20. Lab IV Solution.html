<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Lab IV: Solution</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>GraphQL APIs</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Introduction.html">01. Introduction</a>
    </li>
    <li class="">
      <a href="02. Overview.html">02. Overview</a>
    </li>
    <li class="">
      <a href="03. Schemas.html">03. Schemas</a>
    </li>
    <li class="">
      <a href="04. Operations.html">04. Operations</a>
    </li>
    <li class="">
      <a href="05. GraphiQL.html">05. GraphiQL</a>
    </li>
    <li class="">
      <a href="06. Case Study Steps.html">06. Case Study: Steps</a>
    </li>
    <li class="">
      <a href="07. Case Study Bootstrap &amp; Configure.html">07. Case Study: Bootstrap &amp; Configure</a>
    </li>
    <li class="">
      <a href="08. Lab I Build a Dog GraphQL API (Set Up).html">08. Lab I: Build a Dog GraphQL API (Set Up)</a>
    </li>
    <li class="">
      <a href="09. Lab I Solution.html">09. Lab I: Solution</a>
    </li>
    <li class="">
      <a href="10. Case Study Schema Creation.html">10. Case Study: Schema Creation</a>
    </li>
    <li class="">
      <a href="11. Lab II Build a Dog GraphQL API (Schema).html">11. Lab II: Build a Dog GraphQL API (Schema)</a>
    </li>
    <li class="">
      <a href="12. Lab II Solution.html">12. Lab II: Solution</a>
    </li>
    <li class="">
      <a href="13. Case Study Queries &amp; Mutations.html">13. Case Study: Queries &amp; Mutations</a>
    </li>
    <li class="">
      <a href="14. Case Study Exception Handling.html">14. Case Study: Exception Handling</a>
    </li>
    <li class="">
      <a href="15. Lab III Build a Dog GraphQL API (Queries &amp; Exceptions).html">15. Lab III: Build a Dog GraphQL API (Queries &amp; Exceptions)</a>
    </li>
    <li class="">
      <a href="16. Lab III Solution.html">16. Lab III: Solution</a>
    </li>
    <li class="">
      <a href="17. Case Study Testing.html">17. Case Study: Testing</a>
    </li>
    <li class="">
      <a href="18. Case Study GraphiQL.html">18. Case Study: GraphiQL</a>
    </li>
    <li class="">
      <a href="19. Lab IV Build a Dog GraphQL API (Testing).html">19. Lab IV: Build a Dog GraphQL API (Testing)</a>
    </li>
    <li class="">
      <a href="20. Lab IV Solution.html">20. Lab IV: Solution</a>
    </li>
    <li class="">
      <a href="21. Recap.html">21. Recap</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">20. Lab IV: Solution</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3></h3>
  <div>
  <h1 id="solution-build-a-dog-graphql-api---testing">Solution: Build a Dog GraphQL API - Testing</h1>
<p>Below, we'll walk through each step of the lab and look at one potential way to implement the lab. Even if you get stuck, you should always first try to work through the lab without the solution before coming here, so that you can best learn the related skills and be ready for the project at the end of the course.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="step-1-create-a-datasql-file"><strong>Step 1:</strong> Create a <code>data.sql</code> file.</h2>
<ul>
<li>The file should create sample dog data in the database.</li>
</ul>
<p>You can re-use your previous <code>data.sql</code> file or make a new one.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="step-2-check-that-the-graphql-api-works-appropriately"><strong>Step 2:</strong> Check that the GraphQL API works appropriately.</h2>
<p>First, check that your schema shows appropriately at <a href="http://localhost:8080/graphql/schema.json" target="_blank">http://localhost:8080/graphql/schema.json</a>. You might consider getting a browser extension or another tool to show formatted json as well, otherwise this will look like a large wall of text.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/graphql-schema-updated.png" alt="Example JSON from a schema" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>Example JSON from a schema</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>Now, let's go to <a href="https://www.getpostman.com/downloads/" target="_blank">Postman</a> to test out whether the queries and mutators we want actually work.</p>
<p>First, make sure you are using a <code>POST</code> request, then add our graphQL URL http://localhost:8080/graphql to the app. Then, Make sure to add a Header with <code>Content-Type</code> as <code>application/json</code>.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/java-graphql-postman.png" alt="Adding a POST request to our GraphQL API" class="img img-fluid">
    <figcaption class="figure-caption">
      <p>Adding a POST request to our GraphQL API</p>
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <p>Now, we can test out our queries. Let's look at an example for how a user would accomplish their needs based on the lab query operations. I also added <code>id</code> below to know which belongs to each dog, but they could just as easily skip that and only return the specific data they want (you need at least one item selected with GraphQL, and can do multiple at once - but you cannot grab all data without specifying each individual field).</p>
<p>For each of these below, enter them into "Body" in Postman and then "Send" the request.</p>
<h4 id="finddogbreeds">findDogBreeds</h4>
<pre><code>{
    "query":"{findAllDogs { id breed } }"
}</code></pre>
<p>which returns:</p>
<pre><code>{
    "data": {
        "findAllDogs": [
            {
                "id": "1",
                "breed": "Pomeranian"
            },
            {
                "id": "2",
                "breed": "Pit Bull"
            },
            {
                "id": "3",
                "breed": "Cocker Spaniel"
            },
            {
                "id": "4",
                "breed": "Direwolf"
            },
            {
                "id": "5",
                "breed": "Husky"
            }
        ]
    }
}</code></pre>
<h4 id="finddogbreedbyid">findDogBreedById</h4>
<pre><code>{
    "query":"{findAllDogs { id breed } }"
}</code></pre>
<p>which returns:</p>
<pre><code>{
    "data": {
        "findDogById": {
            "id": "1",
            "breed": "Pomeranian"
        }
    }
}</code></pre>
<p>You should also try out an invalid ID with this to check your error handling. As part of the returned JSON, I got <code>Exception while fetching data (/findDogById) : Dog Not Found</code>.</p>
<h4 id="findalldognames">findAllDogNames</h4>
<pre><code>{
    "query":"{findAllDogs { id name } }"
}</code></pre>
<p>which returns:</p>
<pre><code>{
    "data": {
        "findAllDogs": [
            {
                "id": "1",
                "name": "Fluffy"
            },
            {
                "id": "2",
                "name": "Spot"
            },
            {
                "id": "3",
                "name": "Ginger"
            },
            {
                "id": "4",
                "name": "Lady"
            },
            {
                "id": "5",
                "name": "Sasha"
            }
        ]
    }
}</code></pre>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h3 id="mutations">Mutations</h3>
<p>Let's say we want to change the name of dog four to "Ghost". There's a slightly different syntax, that needs <code>mutation</code> included in the query as well. Also, make sure to use the escape character <code>\</code> to include quotation marks for strings.</p>
<h4 id="updatedogname">updateDogName</h4>
<pre><code>{
    "query":"mutation {updateDogName(newName:\"Ghost\", id:4) { id name breed } }"
}</code></pre>
<p>which returns:</p>
<pre><code>{
    "data": {
        "updateDogName": {
            "id": "4",
            "name": "Ghost",
            "breed": "Direwolf"
        }
    }
}</code></pre>
<p>Make sure to test out an invalid ID here too!</p>
<h4 id="deletedogbreed">deleteDogBreed</h4>
<p>For this, you do not need to add the field specifications afterward.</p>
<pre><code>{
    "query":"mutation {deleteDogBreed(breed:\"Pomeranian\")}"
}</code></pre>
<p>which returns:</p>
<pre><code>{
    "data": {
        "deleteDogBreed": true
    }
}</code></pre>
<p>If you added an <code>Exception</code> for a missing breed, make sure to test that here too!</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h2 id="full-solution">Full Solution</h2>
<p>If you'd like the full solution code all in one place, you can download it through the link below.</p>
</div>

</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="21. Recap.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://github.com/udacimak/udacimak#readme" target="_blank">udacimak v1.4.4</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('20. Lab IV: Solution')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
